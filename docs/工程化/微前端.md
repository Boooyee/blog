### 前端微服务的几种方式

* 使用http服务器路由重定向多个应用
* 在不同框架之上设计通信，加载机制，例如single-spa
* iFrame，使用iframe及自定义消息传递机制

### iframe和single-spa优缺点

* iframe（缺点：5，优点：2）
  + 缺点：
    - 页面加载问题：影响主页面加载，阻塞onload事件，本身加载也很慢，页面缓存过多会导致电脑卡顿（无法解决）
    - 布局问题：iframe必须给一个指定的高度，否则会坍塌。
    - 弹窗及遮罩层问题：只能在iframe范围内垂直水平居中，没法在整个页面垂直水平居中。
      - 通过与框架页面消息同步解决，将弹窗消息发送给主页面，主页面来弹窗，对原项目改动大且影响原项目使用
      - 修改弹窗的样式：隐藏遮罩层，修改弹窗的位置。
      - iframe无法实现占满屏幕弹窗

    - 浏览器前进后退问题：iframe和主页面共用一个浏览历史，iframe会影响页面的前进后退。iframe页面刷新会重置（比如列表页跳到详情页，然后刷新，会返回列表页）
    - 系统之间通信需要postMessage

  + 优点
    - 完全隔离了css和js，避免了系统之间的样式和js污染
    - 可以在子系统完全不修改的前提下嵌入进来

* single-spa优缺点（）
  + 优点：
    - 加载快，可以将所有系统共用的模块提取出来，实现按需加载，一次加载，其他复用
    - http请求少，服务器压力小
    - 用户体验好，快，内容修改不需要加载整个页面，避免了不必要的跳转和重复渲染

  + 缺点
    - css和js需要制定规范进行隔离，否则造成全局污染
    - 子系统需要配合修改，不影响子系统独立开发部署，路由系统对子系统有一定改动，但是不影响功能

### single-spa

* 基座
  + 在基座里调用single-spa提供的registerApplication和start方法
  + registerApplication参数有四个appNameOrConfig、appOrLoadApp、activeWhen、customProps。分别对应注册子项目名和一些配置、加载子项目执行的fn、执行的规则、通信参数。

* 子项目
  + 三个方法：bootstrap、mount、unmount
  